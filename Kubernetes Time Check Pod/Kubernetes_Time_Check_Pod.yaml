---
apiVersion: v1
kind: Namespace
metadata:
  name:  xfusion
---
apiVersion: v1
kind: ConfigMap
metadata:
  name: time-config-practice
  namespace: xfusion
  labels:
    app: "time-check"
data:
  TIME_FREQ: "8"
---
apiVersion: v1
kind: Pod
metadata:
  name: "time-check-practice"
  namespace: xfusion
  labels:
    app: "time-check"
spec:
  containers:
  - name: time-check
    image: "busybox:latest"
    command: [ "bash", "-c", "--" ]
    args: ["while true; do date; sleep $TIME_FREQ;done >> /opt/data/time/time-check.log"]
    resources:
      limits:
        cpu: 200m
        memory: 500Mi
      requests:
        cpu: 100m
        memory: 200Mi
    env:
    - name: DB_HOST
      valueFrom:
        configMapKeyRef:
          name: time-config
          key: TIME_FREQ
    volumeMounts:
    - name: log-volume
      mountPath: /opt/data/time
  restartPolicy: Always
  volumes:
  - name: log-volume
    emptyDir: {}